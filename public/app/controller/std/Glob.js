/*
 * File: app/controller/std/Glob.js
 *
 * This file was generated by Sencha Architect version 4.2.3.
 * http://www.sencha.com/products/architect/
 *
 * This file requires use of the Ext JS 6.5.x Classic library, under independent license.
 * License of Sencha Architect does not include license for Ext JS 6.5.x Classic. For more
 * details see http://www.sencha.com/license or contact license@sencha.com.
 *
 * This file will be auto-generated each and everytime you save your project.
 *
 * Do NOT hand edit this file.
 */

Ext.define('app.controller.std.Glob', {
    extend: 'Ext.app.Controller',
    alias: 'controller.stdGlob',

    requires: [
        'Ext.window.Toast'
    ],

    statics: {
        ajax: function(metodo, url, parm) {
            out='';
            isLogged=false;

            Ext.Ajax.request({
                url: 'is_logged_in',
                method: 'GET',
                async: false,
                headers: {
                    'Accept': 'application/json'
                },

                callback: function(options, success, response) {
                    var resp = response.responseText;
                    if (resp.constructor === "".constructor) {
                        try {
                            out = Ext.JSON.decode(resp);
                            isLogged = true;
                        }
                        catch(err) {}
                    }
                }
            });


            if(isLogged){
                if(!parm){parm={};}
                Ext.Ajax.request({
                    url: url,
                    method: metodo,
                    async: false,
                    params:parm,
                    headers: {
                        'Accept': 'application/json'
                    },

                    callback: function(options, success, response) {
                        var resp = response.responseText;
                        out = resp;

                        if (resp.constructor === "".constructor) {
                            try {
                                out = Ext.JSON.decode(resp);
                            }
                            catch(err) {}
                        }
                    }
                });
            }else{
                window.open('login','_self');
            }




            return out;
        }
    }
});
