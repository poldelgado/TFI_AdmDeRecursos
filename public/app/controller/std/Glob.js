/*
 * File: app/controller/std/Glob.js
 *
 * This file was generated by Sencha Architect version 4.2.3.
 * http://www.sencha.com/products/architect/
 *
 * This file requires use of the Ext JS 6.5.x Classic library, under independent license.
 * License of Sencha Architect does not include license for Ext JS 6.5.x Classic. For more
 * details see http://www.sencha.com/license or contact license@sencha.com.
 *
 * This file will be auto-generated each and everytime you save your project.
 *
 * Do NOT hand edit this file.
 */

Ext.define('app.controller.std.Glob', {
    extend: 'Ext.app.Controller',
    alias: 'controller.stdGlob',

    requires: [
        'Ext.window.Toast'
    ],

    statics: {
        ajax: function(metodo,url ,parm) {
			if(!parm){parm={};}
			Ext.Ajax.request({
                url: url,
				method: metodo, 
                async: false,
				params:parm,
                headers: {
                    'Accept': 'application/json'
                },

                callback: function(options, success, response) {
                    var resp = response.responseText;
                    out = resp;
					
					if (resp.constructor === "".constructor) {
						
						try {
							out = Ext.JSON.decode(resp);
						}
						catch(err) {
							
						}
						
					}
                }
            });
			
            return out;
        },

        getDataGrid: function(grid) {
            var aux = [];
            var fields = grid.store.model.getFields(),
                data = Ext.pluck(grid.store.data.items, 'data');

            for (var i = 0; i < data.length; i++) {
                var obj = data[i],
                    oAux = {};
                for (var key in obj) {
                    for (f in fields) {
                        if (fields[f].name === key && fields[f].persist && fields[f].name !== 'id') {
                            oAux[key] = obj[key];
                        }
                    }
                }
                aux.push(oAux);
            }
            data = aux;

            return data;
        }
    }
});
