/*
 * File: app/view/std/Periodo.js
 *
 * This file was generated by Sencha Architect version 4.2.3.
 * http://www.sencha.com/products/architect/
 *
 * This file requires use of the Ext JS 6.5.x Classic library, under independent license.
 * License of Sencha Architect does not include license for Ext JS 6.5.x Classic. For more
 * details see http://www.sencha.com/license or contact license@sencha.com.
 *
 * This file will be auto-generated each and everytime you save your project.
 *
 * Do NOT hand edit this file.
 */

Ext.define('app.view.std.Periodo', {
    extend: 'Ext.form.field.ComboBox',
    alias: 'widget.stdPeriodo',

    config: {
        conValue: false
    },

    fieldLabel: 'Periodo',
    labelAlign: 'right',
    labelWidth: 80,
    displayField: 'valor',
    valueField: 'id',
    defaultListenerScope: true,

    listeners: {
        beforerender: 'onComboboxBeforeRender'
    },

    onComboboxBeforeRender: function(component, eOpts) {
        var sentido = component.perSentido 	|| 'ASC',
            perIni	= component.perInicial 	|| 0,
            mesesDes= component.perMesesDes	|| 5,
            meses 	= component.perMeses	|| 12;


        var fch 	= new Date(), pers = [];
        var perAct 	= fch.getFullYear() *100+ fch.getMonth()+1;

        if(perIni>0){
            var y = parseInt(inicial/100),
                m = inicial - y*100;
            fch.setFullYear(y);
            fch.setMonth(m-1);
        }else{
            fch.setMonth(fch.getMonth() - mesesDes);
        }


        for(var i=0;i < meses+mesesDes;i++){
            var per 	= fch.getFullYear() *100+ fch.getMonth()+1;
            pers.push({id:per, valor:per.toString().substring(0, 4)+'-'+per.toString().substring(4,7)});
            fch.setMonth(fch.getMonth() + 1);
        }
        var store = Ext.create('Ext.data.Store', {
            fields: ['id', 'valor'],
            pageSize:meses+mesesDes,
            data : pers
        });
        component.store = store;

        if(component.conValue){
            component.setValue(perAct);
        }
    }

});